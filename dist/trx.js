var EventStream,Observable,Property,applyExtraction,applyFilter,applyMapping,assertDomNode,assertFunction,assertNotNull,assertString,fromDomEvent,isArray,isDomNode,isFunction,isNumber,isObject,isString,needlesInHaystack,__bind=function(t,n){return function(){return t.apply(n,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,n){function r(){this.constructor=t}for(var e in n)__hasProp.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Observable=function(){function t(){this.publish=__bind(this.publish,this),this.subscribe=__bind(this.subscribe,this),this._subscribers=[],this._init.apply(this,arguments)}return t.prototype.subscribe=function(t){return this._subscribers.push(t),this},t.prototype.publish=function(t){var n,r,e,i;for(i=this._subscribers,r=0,e=i.length;e>r;r++)(n=i[r])(t);return this},t}(),Property=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype._init=function(t,n,r){var e;return null==r&&(r=0),assertFunction(t),assertFunction(n),this._value=r,e=this,t(function(t){return e._value=n(e._value,t),e.publish(e._value)})},n}(Observable),EventStream=function(t){function n(){return this.filter=__bind(this.filter,this),this.later=__bind(this.later,this),this.extract=__bind(this.extract,this),this.map=__bind(this.map,this),this.merge=__bind(this.merge,this),this.addEvent=__bind(this.addEvent,this),n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype._init=function(t){return isFunction(t)?t(this.publish):void 0},n.prototype.addEvent=function(t){return t(this.publish)},n.prototype.merge=function(t){var r;return r=this,new n(function(n){return r.subscribe(function(t){return n(t)}),t.subscribe(function(t){return n(t)})})},n.prototype.map=function(t){var r;return r=this,new n(function(n){return applyMapping(r.subscribe,n,t)})},n.prototype.extract=function(t){var r;return r=this,new n(function(n){return applyExtraction(r.subscriber,n,t)})},n.prototype.later=function(t,n,r){var e,i,o;return i=this,e=function(){return i.publish(n)},o=setTimeout(e,t),isFunction(r)?r(function(){return clearTimeout(o)}):void 0},n.prototype.filter=function(t,r){var e;return e=this,new n(function(n){return applyFilter(e.subscribe,n,t,r)})},n}(Observable),applyMapping=function(t,n,r){return assertNotNull(t,n,r),isFunction(r)?t(function(t){return n(r(t))}):isString(r)||isNumber(r)?t(function(){return n(r)}):void 0},applyFilter=function(t,n,r){return assertNotNull(t,n,r),isFunction(r)?t(function(t){return r(t)?n(t):void 0}):isObject(r)?t(function(t){return needlesInHaystack(r,t)?n(t):void 0}):void 0},applyExtraction=function(t,n,r){return isFunction(r)?t(function(t){return n(r(t))}):isString(r)?t(function(t){return n(t[r])}):void 0},needlesInHaystack=function(t,n){var r,e,i,o,s,u;r=!0;for(e in t)if(u=t[e],isObject(u)){o=t[e];for(i in u)if(s=u[i],s!==n[e][i]){r=!1;break}}else if(u!==n[e]){r=!1;break}return r},assertFunction=function(t){if(!isFunction(t))throw new Error("variable must be function -> "+t)},assertString=function(t){if(!isString(t))throw new Error("variable must be String -> "+t)},assertDomNode=function(t){if(!isDomNode(t))throw new Error("variable must be html element ->"+t)},assertNotNull=function(t){var n,r,e,i;for(isArray(t)||(t=[t]),i=[],r=0,e=t.length;e>r;r++){if(n=t[r],!n)throw new Error("variable can not be null");i.push(void 0)}return i},isObject=function(t){return!!t&&t.constructor===Object},isNumber=function(t){return"number"==typeof t||t instanceof Number},isDomNode=function(t){return t.hasOwnProperty("nodeType")},isString=function(t){return"string"==typeof t||t instanceof String},isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction=function(t){return t instanceof Function},fromDomEvent=function(t,n){return assertNotNull(arguments),assertDomNode(n),isArray(t)||(t=[t]),new EventStream(function(r){var e,i,o,s;for(s=[],i=0,o=t.length;o>i;i++)e=t[i],s.push(n.addEventListener(e,function(t){return r(t)}));return s})},window.trx={createStream:function(t){return new EventStream(t)},fromDomEvent:fromDomEvent,createProperty:function(t,n,r){return new Property(t,n,r)}};